---
title : 动作条
author: zozoh(zozohtnt@gmail.com)
---

----------------------------------------------------
# 什么是动作条

为用户提供命令操作的界面

----------------------------------------------------
# 设计应用场景

- 应用程序菜单栏
- 工具条
- 按钮组合

----------------------------------------------------
# 设计思路

动作条是一个组合控件，它内嵌了下面几种*私有*控件:

- `动作(bar-action)`: 或者我们可以说是按钮
  + 用户触发
  + 可指定另外的状态，包括加载中，高亮等
  + 用户可指定一个候选参数选择控件
  + 候选参数默认为 `true`
  + `?`可以记忆候选参数
    - 本地存储
    - 仅在控件的生命周期内
  + 可指定是发出事件还是直接调用回调
- `开关(bar-switcher)`: 多个状态开关
  + 同时显示多个状态，只有一个高亮
  + 可选的标签文字
  + 可指定是发出事件还是直接调用回调
- `动作组(bar-group)`
  + hover 或者 click 触发下拉
  + 里面包含更多的`动作组`或者`动作`或者`分隔线`
- `分隔线(bar-line)`

----------------------------------------------------
# 使用方式

----------------------------------------------------
## ti-actionbar 属性

 Prop   | Comment
--------|-------------------
`value` | 动作条配置，数组，每个元素对应一个动作条项目
`align` | 动作条的排布 `*left|right|center`
`status`| 动作条的各个动作状态集合

----------------------------------------------------
## ti-actionbar 事件

### change

截获子控件的 `change` 事件，并转发。

譬如，截获了

```html
<bar-action @change="$notify('change', {[$event.name]:$event.value})"/>
<!--
  就是说，如果截获了 change: {name:"save", value:true}
  则会发出
  change: {save:true}
-->
```

----------------------------------------------------
## bar-action 属性

 Prop     | Example   | Comment
----------|-----------|-------
`type`    | `action`  | 必须为 `action`
`name`    | `save`    | 【自】全动作条唯一名称
`value`   | `true`    | 通知事件的值
`icon`    | `fas-xx`  | 按钮图标
`text`    | `i18n:xx` | 按钮文字
`tip`     | `i18n:xx` | 提示说明
`shortcut`| `CTRL+S`  | 快捷键
`action`  | `dispath:..` | 执行动作
`notify`  | `{..}`    | 通知事件
`wait`    | `500`     | 在一定的时间内阻止重复执行（毫秒）默认0
`altDisplay` | `{..}` | 根据不同的状态切换的显示
`status`   | `{..}` | 动作条的各个动作状态集合
`enableBy` | `changed` | 指明由哪个状态启用
`disableBy`| `saving`  | 指明由哪个状态关闭

> 不声明`type`的话，只要声明了`action`或`notify`就会被认为是动作按钮

----------------------------------------------------
### value

通知事件参数值，默认为`true`，也可以声明更复杂的值

----------------------------------------------------
### action

请参看 [动作执行](../../core/action_invoking.md)

----------------------------------------------------
### notify

动作触发后，将会触发消息参数，具体设置为：

```js
{
  name:  "save",   // 通知事件参数对象的name段，默认为 bar-action.name
  value: true      // 通知事件参数对象的value段，默认为 true
}
```

> `notify:true` 与 `notify:{name:"save",value:true}` 等效

当动作触发后，动作条父控件会截获这个事件，并转发出去：

```js
vm.$notify("change", {save:true})
```

----------------------------------------------------
### altDisplay

声明了一组显示切换

```js
altDisplay: [{
  text: "xxx",      // 切换文字，默认采用bar-action.text
  icon: "fas-xx",   // 切换图标，默认采用bar-action.icon
  match: "saving",  // 切换条件, @see 下面的【状态匹配】详细描述
  disable: true,    // 按钮为失效状态，默认 false
  capture: true,    // 本状态将捕获所有鼠据事件阻止用户操作, 默认 false
  highlight: true,  // 高亮显示按钮，默认 false
}]
```

> 如果只有一种切换状态，可以直接写对象，不用数组包裹

----------------------------------------------------
### 状态匹配

对于 `altDisplay|enableBy|disableBy` 三个属性，会用到状态的动态匹配。
动态匹配可以是下面几种形式

Type | Example | Comment
-----|---------|--------------
Key    | `"saving"` | 状态表某个字段段为`truthy`
KeySet | `["saving","changed"]` | 状态表多个字段同时为`truthy`
Match  | `{saving:true}` | 采用`_.isMatch`匹配状态表
Validate | `{validate:{..}}` | 采用 `Ti.Validate` 匹配状态表

----------------------------------------------------
### enableBy

声明了这个属性后，只有其为`真`才会启用动作，其值的格式参看上文的【状态匹配】

----------------------------------------------------
### disableBy

声明了这个属性后，如果其为`真`会失效动作，其值的格式参看上文的【状态匹配】。
本属性如果与`enableBy`效果重叠，以`enableBy`为准。

----------------------------------------------------
## bar-action 事件

### change

参数格式请参看 `notify` 属性介绍

----------------------------------------------------
## bar-group 属性

 Prop     | Example   | Comment
----------|-----------|-------
`type`    | `group`  | 必须为 `group`
`name`    | `save`    | 【自】全动作条唯一名称
`icon`    | `fas-xx`  | 按钮图标
`text`    | `i18n:xx` | 按钮文字
`tip`     | `i18n:xx` | 提示说明
`items`   | `[..]`    | 包含的动作和组
`autoExtend`| `false` | 如果有空间可能，自动展开组的内容

> 不声明`type`的话，只要声明了`items`就会被认为是动作按钮

----------------------------------------------------
## bar-group 事件

```js
// 展开子组
{
  name  : "Group1",
  value : "extended"
}
// 收缩子组
{
  name  : "Group1",
  value : "collapse"
}
```

----------------------------------------------------
# 示例

```js
{
  "value":  [{
    "name": "save",
    "type": "action",
  }]
}
```

