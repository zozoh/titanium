// Define the block header height
$GUI-BLOCK-HEADER-HEIGHT: .4rem;
//---------------------------------------
.ti-gui {
  position: relative;      // For the sub-panles
  width:100%; height:100%; // Always fit the parent
  > .gui-con {
    width:100%; height:100%;
  }
}
//---------------------------------------
// Rows
.ti-gui-rows {
  @include flex-align-v-nowrap;
  //-------------------------------------
  &.show-border {
    > .ti-gui-block {
      @include border(1px, solid, shallow, top);
      &:first-child{border:0;}
    }
  }
  //-------------------------------------
}
//---------------------------------------
// Cols
.ti-gui-cols {
  @include flex-align-nowrap($ai:stretch);
  //-------------------------------------
  &.show-border {
    > .ti-gui-block {
      @include border(1px, solid, shallow, left);
      &:first-child{border:0;}
    }
  }
  //-------------------------------------
}
//---------------------------------------
// Tabs
.ti-gui-tabs {
  position: relative;
  //-------------------------------------
  $tabH : .4rem;
  $tabPad: .08rem;
  //-------------------------------------
  // Docking Position
  &.at-top {
    padding-top: $tabH;
    > header {
      @include pos-abs($l:0,$r:0,$t:0,$h:$tabH);
      border-bottom:1px solid map-get($color-line, shallow);
      padding-bottom: 0;
      li {
        border-top-width:3px;
        border-bottom:0;
        margin-bottom:-1px;
      }
    }
  }
  &.at-bottom {
    padding-bottom: $tabH;
    > header {
      @include pos-abs($l:0,$r:0,$b:0,$h:$tabH);
      border-top:1px solid map-get($color-line, shallow);
      padding-top: 0;
      li {
        border-bottom-width:3px;
        border-top:0;
        margin-top:-1px;
      }
    }
  }
  //-------------------------------------
  // Tab Bar 
  > header {
    padding: $tabPad;
    //-----------------------------------
    @include noselect;
    @include color($color-bar, r, c);
    //-----------------------------------
    &.as-left   ul {@include flex-align-nowrap($ai:stretch);}
    &.as-center ul {@include flex-align-nowrap($ai:stretch, $jc:center);}
    &.as-right  ul {@include flex-align-nowrap($ai:stretch, $jc:flex-end);}
    //-----------------------------------
    ul {
      width:100%; height:100%;
    }
    //-----------------------------------
    li {
      @include flex-center;
      cursor:pointer; 
      border:1px solid transparent;
      min-width: .8rem; 
      padding:0 .1rem;
      line-height:.28rem; 
      font-size:.12rem;
      &.is-current {
        @include color($color-body, r, c);
        border-color:map-get($color-line, shallow);
        border-top-color:map-get($color-primary, c);
        border-bottom-color:map-get($color-primary, c);
        background-color:map-get($color-body, c);
      }
      > .it-icon {
        padding-right:.06rem;
      }
    }
    //-----------------------------------
  }
  //-------------------------------------
  // Main Block Section
  > section {
    width:100%; height:100%;
  }
  //-------------------------------------
}
//---------------------------------------
// Panel
.ti-gui-panel {
  @include flex-center;
  //-----------------------------------
  &.show-mask {
    @include color($color-mask, null, thin);
    @include pos-abs(0,0,100%,100%);
    &.at-center {padding-bottom:19%;}
    &.at-left   {@include flex-as($j:flex-start);}
    &.at-right  {@include flex-as($j:flex-end);}
    &.at-top    {@include flex-as($a:flex-start);}
    &.at-bottom {@include flex-as($a:flex-end);}
    &.at-left-top     {@include flex-as($j:flex-start,$a:flex-start);}
    &.at-right-top    {@include flex-as($j:flex-end  ,$a:flex-start);}
    &.at-bottom-left  {@include flex-as($j:flex-start,$a:flex-end);}
    &.at-bottom-right {@include flex-as($j:flex-end  ,$a:flex-end);}
  }
  //-----------------------------------
  &.no-mask {
    // If center, it should be mask by transparent
    &.at-center {
      @include pos-abs(0,0,100%,100%);
      @include flex-center;
      padding-bottom:19%;
    }
    //---------------------------------
    > .panel-con {
      @include border(1px,solid,dark);
    }
    //---------------------------------
    &.at-left   {@include pos-abs($l:0,$t:0,$b:0); >.panel-con{border-left:0;}}
    &.at-right  {@include pos-abs($r:0,$t:0,$b:0); >.panel-con{border-right:0;}}
    &.at-top    {@include pos-abs($l:0,$t:0,$r:0); >.panel-con{border-top:0;}}
    &.at-bottom {@include pos-abs($l:0,$b:0,$r:0); >.panel-con{border-bottom:0;}}
    &.at-left-top     {@include pos-abs($l:0,$t:0); >.panel-con{border-left:0;border-top:0;}}
    &.at-right-top    {@include pos-abs($r:0,$t:0); >.panel-con{border-right:0;border-top:0;}}
    &.at-bottom-left  {@include pos-abs($b:0,$l:0); >.panel-con{border-bottom:0;border-left:0;}}
    &.at-bottom-right {@include pos-abs($b:0,$r:0); >.panel-con{border-bottom:0;border-right:0;}}
    //---------------------------------
  }
  //-----------------------------------
  > .panel-con {
    @include color($color-body, r, c);
    position: relative;
  }
  //-----------------------------------
  // If closer is default, make more space
  // for it in block title bar
  &.is-closer-default {
    > .panel-con > .ti-gui-block > .block-head > .as-actions {
      padding-right: $GUI-BLOCK-HEADER-HEIGHT + .04rem;
    }
  }
  //-----------------------------------
  $foot-closer-size : 80px;
  .panel-closer {
    position: absolute;
    @include flex-center;
    //--------------------------------------
    &.as-lamp-cord {
      > .ti-icon {
        color:rgba(255,255,255,0.8); 
        border:1px solid rgba(255,255,255,0.8);
        background:rgba(50,50,50,0.4);
        border-radius: 50%;
        width:32px; height:32px;
        cursor: pointer;
        display:block;
        transition: all 0.8s;
        > .icon-icon {
          display: block; width:100%; height:100%;
          > i {
            width:100%; height:100%;
            line-height: 32px; text-align: center;
            font-size:21px; font-weight: 400;
            transition: all 0.3s;
          }
        }
        &:hover {
          @include color($color-secondary, r, c);
          border-color:transparent;
          box-shadow:0 0 10px 4px map-get($color-light, c);
          > .icon-icon > i {
            transform: rotate(180deg);
          }
        }
      }
      //--------------------------------------
      &.at-top {
        height: $foot-closer-size;
        top: $foot-closer-size * -1;
        left:0; right:0;
      }
      &.at-bottom {
        height: $foot-closer-size;
        bottom: $foot-closer-size * -1;
        left:0; right:0;
      }
      &.at-left {
        width: $foot-closer-size;
        left: $foot-closer-size * -1;
        top:0; bottom:0;
      }
      &.at-right {
        width: $foot-closer-size;
        right: $foot-closer-size * -1;
        top:0; bottom:0;
      }
    }
    //----------------------------------
    &.as-default {
      top:0; right:0; 
      //--------------------------------
      > .ti-icon {
        @include flex-center;
        @include color($color-func, r, c);
        cursor: pointer;
        width:$GUI-BLOCK-HEADER-HEIGHT; 
        height:$GUI-BLOCK-HEADER-HEIGHT;
        //------------------------------
        > .icon-icon {
          > i {
            transition: transform 0.3s;
          }
        }
        //------------------------------
        &:hover {
          @include color($color-secondary, r, c);
          > .icon-icon > i {
            transform: rotate(180deg) scale(1.2);
          }
        }
        //------------------------------
      }
      //--------------------------------
    }
  } // .panel-closer
} // .ti-gui-panel
//---------------------------------------
// Block
.ti-gui-block {
  position: relative;
  //-------------------------------------
  &.is-flex-grow   {flex:1 0 auto;}
  &.is-flex-shrink {flex:0 1 auto;}
  &.is-flex-both   {flex:1 1 auto;}
  &.is-flex-none   {flex:0 0 auto;}
  //-------------------------------------
  &.is-show-header {
    padding-top: $GUI-BLOCK-HEADER-HEIGHT;
    > .block-head {
      //---------------------------------
      @include noselect;
      @include pos-abs($l:0,$r:0,$t:0,$h:$GUI-BLOCK-HEADER-HEIGHT);
      @include flex-align-nowrap($ai:stretch);
      @include color($color-bar, r, c);
      @include border(1px, solid, shallow, bottom);
      //---------------------------------
      line-height: $GUI-BLOCK-HEADER-HEIGHT;
      padding:0 0 0 .06rem;
      //---------------------------------
      > .as-icon {
        @include flex-center;
        padding-left:.06rem;
      }
      //---------------------------------
      > .as-title {
        flex:1 0 auto;
        padding:0 .06rem;
      }
      //---------------------------------
      > .as-actions {
        @include flex-align-nowrap;
        padding:0 .04rem 0 0;
        font-size: .9em;
      }
      //---------------------------------
    }
  }
  //-------------------------------------
  > .block-main {
    width:100%; height:100%; 
    position: relative;
    > .block-main-con {
      &.can-flex-none {
        width:100%; height:100%;
      }
      &.can-flex-shrink {
        @include pos-abs-full;
        //overflow: hidden;
      }
    }
  }
  //-------------------------------------
}
//---------------------------------------
// Animation
//---------------------------------------
@mixin gui-trans($name, $trans, $tor:null, $du:.3s) {
  .ti-gui-panel-#{$name}-enter-active, 
  .ti-gui-panel-#{$name}-leave-active {
    transition: opacity $du;
    > .panel-con {
      transition: transform $du ease;
      @if $tor != null {
        transform-origin: $tor;
      }
    }
  }
  .ti-gui-panel-#{$name}-enter, 
  .ti-gui-panel-#{$name}-leave-to  {
    opacity: 0;
    > .panel-con {transform: $trans;}
  }
}
@include gui-trans(top,    translateY(-300px));
@include gui-trans(left,   translateX(-300px));
@include gui-trans(right,  translateX(300px));
@include gui-trans(bottom, translateY(300px));
@include gui-trans(center, scale(0));
@include gui-trans(left-top,     scale(0), left top);
@include gui-trans(right-top,    scale(0), right top);
@include gui-trans(bottom-left,  scale(0), bottom left);
@include gui-trans(bottom-right, scale(0), bottom right);
