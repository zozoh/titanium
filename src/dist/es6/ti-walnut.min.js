const Io=function(){function e(e){return"/o/"+e}function t(e,t){if(!e.ok){if(_.isUndefined(t))throw e;return t}return e.data}const i={isFullObjId:e=>/^[0-9a-v]{26}(:.+)?$/.test(e),isFullObjIdPath:e=>/^id:[0-9a-v]{26}(:.+)?$/.test(e),async loadMetaBy(e,t){if(i.isFullObjId(e))return await i.loadMetaById(e);if(/^(id:|\/|~)/.test(e))return await i.loadMeta(e);let n;n=t?_.isString(t)?Ti.Util.getParentPath(t):"FILE"==t.race?"id:"+t.pid:"id:"+t.id:"~";let a=Ti.Util.appendPath(n,e);return await i.loadMeta(a)},loadMetaById:async e=>await i.loadMeta("id:"+e),async loadMeta(i){let n=e("fetch");return t(await Ti.Http.get(n,{params:{str:i},as:"json"}),null)},async loadMetaAt(e,t){let n=t;return e&&!/^(~\/|\/|id:)/.test(t)&&(n=`id:${e.pid}/${t}`),await i.loadMeta(n)},async loadAncestors(i){let n=e("ancestors");return t(await Ti.Http.get(n,{params:{str:i},as:"json"}),[])},async loadChildren(n,{skip:a,limit:s,sort:o={nm:1},mine:r,match:l={}}={}){if(!n)return null;if("DIR"!=n.race)return 0===s?[]:{};if(n.mnt||n.ln){let i=e("children");return t(await Ti.Http.get(i,{params:{str:`id:${n.id}`,pg:!0},as:"json"}))}l.pid=n.id;let c=await i.find({skip:a,limit:s,sort:o,mine:r,match:l});if(n.ph&&c&&_.isArray(c.list))for(let e of c.list)e.ph||(e.ph=Ti.Util.appendPath(n.ph,e.nm));return c},async find({skip:i=0,limit:n=100,sort:a={},mine:s=!0,match:o={}}={}){let r=e("find");return t(await Ti.Http.get(r,{params:_.assign({},o,{_l:n,_o:i,_me:s,_s:JSON.stringify(a)}),as:"json"}))},async findList(e={}){let t=await i.find(e);return t&&_.isArray(t.list)?t.list:[]},async findInBy(e,t,{skip:n=0,limit:a=100,sort:s={},mine:o=!0,match:r={},keys:l={"^[0-9a-v]{26}(:.+)$":["id","${val}"]},dftKey:c=["nm","^.*${val}.*$"]}={}){if(!_.isUndefined(e)){let t=c;for(let i of _.keys(l))if(new RegExp(i).test(e)){t=l[i];break}let i=t[0],n=Ti.S.renderBy(t[1],{val:e});r[i]=n}if(t&&t.id&&t.ph)r.pid=t.id;else if(_.isString(t)){let e=await i.loadMeta(t);r.pid=e.id}return await i.find({skip:n,limit:a,sort:s,mine:o,match:r})},async findListInBy(e,t,n={}){let a=await i.findInBy(e,t,n);return a&&_.isArray(a.list)?a.list:[]},async loadContent(t,{as:n="text"}={}){if(_.isString(t)&&(t=await i.loadMeta(t)),!t||"DIR"==t.race)return null;let a=t.mime||"application/octet-stream";if(Wn.Util.isMimeText(a)){let i=e("content");return await Ti.Http.get(i,{params:{str:"id:"+t.id,d:"raw"},as:n})}return t.sha1},async update(t,n={}){if(!t||_.isEmpty(n))return;if(_.isString(t)&&(t=await i.loadMetaBy(t)),!_.isPlainObject(t))throw Ti.Err.make("e-wn-io-invalidUpdateTarget",t);let a=e("/update"),s=await Ti.Http.post(a,{params:{str:"id:"+t.id},body:JSON.stringify(n),as:"json"});if(!s.ok)throw Ti.Err.make(s.errCode,s.data,s.msg);return s.data},async saveContentAsText(t,n){if(!t)return;if(Ti.Util.isNil(n)&&(n=""),_.isString(t)&&(t=await i.loadMetaBy(t)),!_.isPlainObject(t))throw Ti.Err.make("e-wn-io-invalidTarget",t);if("DIR"==t.race)throw Ti.Err.make("e-wn-io-writeNoFile",t.ph||t.nm);let a={str:"id:"+t.id,content:n},s=e("/save/text"),o=await Ti.Http.post(s,{params:a,as:"json"});if(!o.ok)throw Ti.Err.make(o.errCode,o.data,o.msg);return o.data},async uploadFile(t,{target:i="~",mode:n="a",tmpl:a="${major}(${nb})${suffix}",progress:s=_.identity}={}){let o=e("/save/stream");return await Ti.Http.post(o,{file:t,progress:s,params:{str:i,nm:t.name,sz:t.size,mime:t.type,m:n,tmpl:a},as:"json"})},getFormedPath(e){let t=e.ph?e.ph:e,i=Wn.Session.getHomePath(),n=Ti.Util.getRelativePath(i,t,"");return Ti.Util.appendPath("~",n)},formatObjPath(e,t,n){let a={path:()=>n?Ti.Util.getRelativePath(n.ph,e.ph):i.getFormedPath(e.ph),fullPath:()=>e.ph,idPath:()=>`id:${e.id}`,id:()=>e.id,obj(){let t=n||["id","nm","thumb","title","mime","tp","sha1","len"];return _.pick(e,t)}}[t];if(!a)throw"Invalid mode : "+t;return a()}};return i}(),Obj=function(){const e={id:{title:"i18n:wn-key-id",name:"id",comType:"WnObjId"},nm:{title:"i18n:wn-key-nm",name:"nm",display:"<=ti-label>",comType:"ti-input"},title:{title:"i18n:wn-key-title",name:"title",emptyAs:null,display:"<=ti-label>",comType:"ti-input"},sort:{title:"i18n:sort",name:"sort",tip:"i18n:sort-tip-asc",type:"Integer",comType:"ti-input-num",comConf:{width:140}},icon:{title:"i18n:wn-key-icon",name:"icon",width:"auto",comType:"ti-input-icon"},ph:{title:"i18n:wn-key-ph",name:"ph",comConf:{className:"is-break-word"}},thumb:{title:"i18n:wn-key-thumb",name:"thumb",checkEquals:!1,serializer:{name:"Ti.Types.toStr",args:"id:${id}"},comType:"wn-imgfile",comConf:{target:"~/.thumbnail/gen/${id}.jpg",filter:"cover(256,256)",quality:.372}},race:{title:"i18n:wn-key-race",name:"race",comConf:{format:"i18n:wn-race-${race}"}},mime:{title:"i18n:wn-key-mime",name:"mime"},tp:{title:"i18n:wn-key-tp",name:"tp"},ct:{title:"i18n:wn-key-ct",name:"ct",type:"AMS"},lm:{title:"i18n:wn-key-lm",name:"lm",type:"AMS"},expi:{title:"i18n:wn-key-expi",name:"expi",type:"AMS"},pid:{title:"i18n:wn-key-pid",name:"pid"},d0:{title:"i18n:wn-key-d0",name:"d0"},d1:{title:"i18n:wn-key-d1",name:"d1"},c:{title:"i18n:wn-key-c",name:"c"},m:{title:"i18n:wn-key-m",name:"m"},g:{title:"i18n:wn-key-g",name:"g"},data:{title:"i18n:wn-key-data",name:"data"},sha1:{title:"i18n:wn-key-sha1",name:"sha1",comConf:{className:"is-nowrap",fullField:!1}},md:{title:"i18n:wn-key-md",name:"md",type:"Integer",comType:"WnObjMode",comConf:{valueType:"decimal"}},pvg:{title:"i18n:wn-key-pvg",name:"pvg",type:"Object",comType:"TiInputText",comConf:{autoJsValue:!0,height:200}},width:{title:"i18n:wn-key-width",name:"width"},height:{title:"i18n:wn-key-height",name:"height"},duration:{title:"i18n:wn-key-duration",name:"duration",width:"auto",comConf:{suffixText:"i18n:tu-sec"}},len:{title:"i18n:wn-key-len",name:"len",width:"auto",transformer:e=>Ti.S.sizeText(e,{bytes:!0})}},t={isValidName:e=>!e||e.search(/[%;:"'*?`\t^<>\/\\]/)>=0?(Ti.Alert("i18n:wn-rename-invalid",{type:"warn"}),!1):!(e.length>256)||(Ti.Alert("i18n:wn-rename-too-long",{type:"warn"}),!1),octalModeToStr(e){let i=parseInt(e,8);return t.modeToStr(i)},modeToStr(e){let t=[];for(let i=2;i>=0;i--){let n=e>>3*i&7;t.push((4&n)>0?"r":"-"),t.push((2&n)>0?"w":"-"),t.push((1&n)>0?"x":"-")}return t.join("")},modeToOctal:e=>e.toString(8),octalModeFromStr:e=>t.modeFromStr(e).toString(8),modeFromOctalMode:e=>parseInt(e,8),modeFromStr(e){let i=0;for(let n=0;n<3;n++){let a=3*(2-n),s=e.substring(a,a+3);i|=t.modeFromStr0(s)<<3*n}return i},modeFromStr0(e){let t=0;return"r"==e[0]&&(t|=4),"w"==e[1]&&(t|=2),"x"==e[2]&&(t|=1),t},modeToObj(e){let i=["other","member","owner"],n={mode:e,text:t.modeToStr(e),octal:e.toString(8)};for(let t=2;t>=0;t--){let a=e>>3*t&7;n[i[t]]={readable:(4&a)>0,writable:(2&a)>0,excutable:(1&a)>0}}return n},modeFromObj:({owner:e,member:i,other:n}={})=>t.mode0FromObj(e)<<6|t.mode0FromObj(i)<<3|t.mode0FromObj(n),mode0FromObj({readable:e,writable:t,excutable:i}={}){let n=0;return e&&(n|=4),t&&(n|=2),i&&(n|=1),n},parseMode(e,i=!1){let n=0;return/^\{.+\}$/.test(e)&&(e=JSON.parse(e)),_.isPlainObject(e)?e.readable?t.mode0FromObj(e):t.modeFromObj(e):(n=/^[rwx-]{3,9}$/.test(e)?3==e.length?t.modeFromStr0(e):t.modeFromStr(e):/^0[0-7]{3}$/.test(e)?t.modeFromOctalMode(e.substring(1)):i?t.modeFromOctalMode(e):parseInt(e),t.modeToObj(n))},isBuiltInFields:t=>!!e[t],getGroupTitle:e=>/^(basic|privilege|thumb|timestamp|more|advance|customized|others)$/.test(e)?`i18n:wn-key-grp-${e}`:e,getField(t){let i=e[t];return i?_.cloneDeep(i):{title:t,name:t,type:"String"}},evalFields(e={},t=[],i=_.identity){const n=function(t=[],i=[],a={}){return _.forEach(t,t=>{if("..."==t)return void i.push(t);let s,o=!1;if(_.isString(t))o=!0,s=Wn.Obj.getField(t);else if(_.isArray(t.fields)){if(s={title:Wn.Obj.getGroupTitle(t.title),type:"Group",fields:[]},n(t.fields,s.fields,a),_.isEmpty(s.fields))return}else s=t;let r=Ti.S.join([s.name],"-");a[r]=!0;let l=_.get(e,s.name);i.push(_.assign(s,{quickName:o,uniqKey:r,value:l}))}),i},a=function(t=[],n=[],s={}){for(let o of t)if("Group"!=o.type)if("..."==o)_.forEach(e,(e,t)=>{if(Ti.Util.isNil(e)||Wn.Obj.isBuiltInFields(t)||s[t]||"children"==t||t.startsWith("_"))return;let a={Integer:{type:"Number",display:t,comType:"ti-input"},Number:{type:"Number",display:t,comType:"ti-input"},Boolean:{type:"Boolean",comType:"ti-toggle"},Array:{type:"Array",display:{key:t},transformer:"JSON.stringify(null, '  ')",comType:"ti-input-text",comConf:{height:240}}}[Ti.Types.getJsType(e,"String")]||{type:"String",display:{key:t,comConf:{width:"100%",className:_.isString(e)&&e.length>20?"is-break-word":"is-nowrap"}},comType:"ti-input"},o=i({title:t,name:t,...a});o&&n.push(o)});else{let e=i(o);e&&n.push(e)}else o.fields=a(o.fields,[],s),_.isEmpty(o.fields)||n.push(o);return n};let s={},o=n(t,[],s);return o=a(o,[],s)},isAs(e={},i,n){let a=_.get(e,i);if(Ti.Util.isNil(a))return!1;if(_.isArray(n)){for(let a of n)if(t.isAs(e,i,a))return!0;return!1}return _.isString(n)?n.startsWith("^")?new RegExp(n).test(a):n.startsWith("!^")?!new RegExp(n.substring(1)).test(a):a==n:!!_.isRegExp(n)&&n.test(a)},isMime:(e={},i)=>t.isAs(e,"mime",i),isType:(e={},i)=>t.isAs(e,"type",i),evalCrumbData({meta:e,ancestors:t=[],fromIndex:i=0,homePath:n=null,titleBy:a,iteratee:s=_.identity,self:o=_.identity}={}){let r=[];if(e){let l=_.map(t),c=i;if(n)for(n.endsWith("/")&&(n=n.substring(0,n.length-1));c<l.length;c++){if(l[c].ph==n)break}for(;c<l.length;c++){let e=l[c],t={icon:Wn.Util.getIconObj(e),text:Wn.Util.getObjDisplayName(e,a),value:e.id,href:Wn.Util.getAppLink(e)+""};(t=s(t,c,e))&&r.push(t)}if(o){let t={icon:Wn.Util.getIconObj(e),text:Wn.Util.getObjDisplayName(e,a),value:e.id,href:null,asterisk:_.get(this.mainStatus,"changed")};_.isFunction(o)&&(t=o(t,c,e)||t),t&&r.push(t)}}return r}};return t}(),Session=function(){const e={},t={},i={setup({id:e,uid:n,unm:a,grp:s,envs:o={}}={}){_.assign(t,{id:e,uid:n,unm:a,grp:s}),i.env(o)},env(t){if(_.isPlainObject(t))_.assign(e,t);else{if(_.isString(t))return e[t];if(_.isArray(t))return _.pick(e,t)}return _.cloneDeep(e)},getLang:()=>i.env("LANG"),getMyId:()=>t.uid,getMyName:()=>t.unm,getMyGroup:()=>t.grp,getHomePath:()=>i.env("HOME"),getCurrentPath:(e="~")=>i.env("PWD")||e,getCurrentDomain(){let e=i.getHomePath();if(!e)return;if("/root"==e)return"root";let t=/^\/home\/(.+)$/.exec(e);return t?t[1]:void 0},getApiPrefix:()=>`/api/${i.getCurrentDomain()}`,getApiUrl(e){let t=i.getApiPrefix();return Ti.Util.appendPath(t,e)}};return i}(),Sys=function(){const WnSysRespParsing=function(){class e{constructor({macroObjSep:e,eachLine:t=_.identity,macro:i={}}={}){this.macroObjSep=e,this.lastIndex=0,this.lines=[],this.MACRO={},this.__TO=null,this.eachLine=t,this.macro=i}init(e){this.content=e}done(){this.updated({isLastCalled:!0}),_.forOwn(this.MACRO,(e,t)=>{let i=e.join("\n"),n=JSON.parse(i);this.MACRO[t]=n,Ti.InvokeBy(this.macro,t,[n])})}__push_line(e){if(e.startsWith(this.macroObjSep)){let t=e.substring(this.macroObjSep.length).trim(),[i,n]=_.without(t.split(/ *: */g),""),a=this[i];a&&(a[n]=[]),this.__TO={key:i,name:n}}else if(this.__TO){let{key:t,name:i}=this.__TO;this[t][i].push(e)}else this.lines.push(e),this.eachLine(e)}updated({isLastCalled:e=!1}={}){let t=this.content();for(;this.lastIndex<t.length;){let i=t.indexOf("\n",this.lastIndex);if(i>=this.lastIndex){let e=i+1;i>0&&"\r"==t[i-1]&&i--;let n=t.substring(this.lastIndex,i);this.__push_line(n),this.lastIndex=e}else{if(!e)break;{let e=t.substring(this.lastIndex);this.__push_line(e),this.lastIndex=t.length}}}}getResult(){return{lines:this.lines,macro:this.MACRO}}}return e}(),DFT_MACRO_OBJ_SEP="%%wn.meta."+Ti.Random.str(10)+"%%",WnSys={async exec(cmdText,{vars:vars={},input:input="",appName:appName=Ti.GetAppName(),eachLine:eachLine,as:as="text",blankAs:blankAs="",macroObjSep:macroObjSep=DFT_MACRO_OBJ_SEP,autoRunMacro:autoRunMacro=!0,forceFlushBuffer:forceFlushBuffer=!1,errorBy:errorBy,PWD:PWD=Wn.Session.getCurrentPath()}={}){cmdText=Ti.S.renderBy(cmdText,vars);let url=`/a/run/${appName}`,params={mos:macroObjSep,PWD:PWD,cmd:cmdText,in:input,ffb:forceFlushBuffer},ing={eachLine:eachLine,macroObjSep:macroObjSep};autoRunMacro&&(ing.macro={update_envs:e=>{Wn.Session.env(e),Wn.doHook("update_envs",e)}});let parsing=new WnSysRespParsing(ing),readyStateChanged=void 0;forceFlushBuffer&&_.isFunction(eachLine)&&(readyStateChanged=(()=>{parsing.updated()})),await Ti.Http.send(url,{method:"POST",params:params,as:"text",created:e=>{parsing.init(()=>e.responseText)},readyStateChanged:readyStateChanged}).catch(e=>{parsing.isError=!0}).finally(()=>{parsing.done()});let re=parsing.getResult();if(Ti.IsInfo("Wn.Sys")&&console.log("Wn.Sys.exec@return",re),parsing.isError){let e=re.lines.join("\n");if(_.isFunction(errorBy)){let[t,...i]=e.split(/ *: */),n=i.join(" : ");t=_.trim(t);let a=t.replace(/[.]/g,"-");return errorBy({code:t,msgKey:a,data:n})}throw e}return{raw:()=>re,lines:()=>re.lines,macro:()=>re.macro,text:()=>re.lines.join("\n"),json:()=>{let e=re.lines.join("\n");Ti.S.isBlank(e)&&(e=blankAs);try{return JSON.parse(e)}catch(t){throw console.error(`Error [${cmdText}] for parse JSON:`,e),t}},jso:()=>{let json=re.lines.join("\n");Ti.S.isBlank(json)&&(json=blankAs);try{return eval("("+json+")")}catch(e){throw console.error(`Error [${cmdText}] for eval JSO:`,json),e}}}[as]()},exec2:async(e,t={})=>(_.defaults(t,{errorBy:async function({code:e,msgKey:i,data:n}){let a=Ti.I18n.get(i);return Ti.Util.isNil(n)||_.isString(n)&&!n||(a+=" : "+Ti.Types.toStr(n)),await Ti.Alert(a,{title:"i18n:warn",type:"error"}),_.isFunction(t.errorAs)?t.errorAs({code:e,msgKey:i,data:n}):Ti.Err.make(e,n)}}),await Wn.Sys.exec(e,t)),execJson:async(e,t={as:"json"})=>await WnSys.exec(e,t),exec2Json:async(e,t={as:"json"})=>await WnSys.exec2(e,t)};return WnSys}(),Util=function(){const e={isMimeText:e=>/^text\//.test(e)||"application/x-javascript"==e||"application/json"==e,isMimeJson:e=>"text/json"==e||"application/json"==e,getIconName(e){let t=/^<i +class=["'] *(fa|zmdi|im) +(fa|zmdi|im)-([^" ]+) *["']> *<\/i>$/.exec(e);return t?t[3]:e},genPreviewObj(t){if(t.thumb)return/https?:\/\//.test(t.thumb)?{type:"image",value:t.thumb}:{type:"image",value:"/o/thumbnail/id:"+t.id};if(t.icon){let i=e.getIconName(t.icon);return Ti.Icons.get(i,{type:"font",value:i})}return Ti.Icons.get(t)},getIconObj:e=>e&&e.icon?e.icon:Ti.Icons.get(e),getObjIcon:(e,t)=>e?e.icon||Ti.Icons.get(e):t,getObjThumbIcon({icon:e,thumb:t,mime:i,type:n,race:a,candidateIcon:s,timestamp:o=0}={},r){if(t){let e=`/o/content?str=${t}`;return o>0&&(e+=`&_t=${o}`),{type:"image",value:e}}return e?{type:"font",value:e}:s||(n||i||a?Ti.Icons.get({type:n,mime:i,race:a}):r)},getObjThumbIcon2(e,t){if(e.thumb){return{type:"image",value:`/o/content?str=${e.thumb}`}}return e.icon?e.icon:t||Ti.Icons.get(e)},getObjDisplayName:(e,t=[])=>Ti.Util.getFallbackEmpty(e,t,"title","nm"),getAppLink:(t,{appName:i="wn.manager",encoded:n=!1}={})=>e.getLink(`/a/open/${i}`,t,{pathKey:"ph",encoded:n}),getAppLinkStr:(t,i)=>e.getAppLink(t,i).toString(),getObjBadges(e={},t){if(_.isFunction(t))return t(e);let{NW:i=null,NE:n=["ln","zmdi-open-in-new"],SW:a=null,SE:s=null}=t||{},o={},r=function(t,i){if(_.isFunction(i)&&(i=i(e)),i)if(_.isArray(i))1==i.length?o[t]=i[0]:i.length>1&&e[i[0]]&&(o[t]=i[1]);else if(_.isPlainObject(i)&&i.value){if(i.test&&!Ti.AutoMatch.test(i.test,e))return;let n=Ti.Util.explainObj(e,{type:i.type||"icon",className:i.className,value:i.value});n&&(o[t]=n)}else o[t]=i};return r("NW",i),r("NE",n),r("SW",a),r("SE",s),o},getObjThumbInfo(t={},{exposeHidden:i=!1,status:n={},progress:a={},badges:s,titleKey:o}={}){if(!t||!t.nm)return;let r="show";return t.nm.startsWith(".")&&i&&(r=i?"weak":"hide"),{id:t.id,nm:t.nm,title:e.getObjDisplayName(t,o),preview:e.genPreviewObj(t),href:e.getAppLinkStr(t),visibility:r,status:n[t.id],progress:a[t.id],badges:e.getObjBadges(t,s)}},getDownloadLink:(t,{mode:i="force"}={})=>e.getLink("/o/content",t,{pathKey:"str",encoded:!0,params:{d:i}}),getMatchByFilter({keyword:e,match:t,majorKey:i,majorValue:n}={},a={}){let s={};if(e)if(/"^[\d\w]{26}(:.+)?$"/.test(e))s.id=e;else{let t=a.defaultKey||"nm",i=_.cloneDeep(a.keyword),n=_.keys(i);for(let a of n){let n=i[a];if(new RegExp(n).test(e)){t=a;break}}t.startsWith("=")?s[t.substring(1).trim()]=e:t.startsWith("~")?s[t.substring(1).trim()]="^"+e:s[t]="^.*"+e}_.isEmpty(t)||_.assign(s,t),i&&!Ti.Util.isNil(n)&&_.set(s,i,n);let o=a.match;return _.isEmpty(o)||_.assign(s,o),s},getLink(e,t,{pathKey:i="ph",encoded:n=!1,params:a={}}={}){let s={...a};if(!t)return{url:e,params2:s};const o=e=>n?encodeURIComponent(e):e;return/^(\/|~|id:)/.test(t)?s[i]=o(t):_.isString(t)?s[i]=`id:${t}`:t.id?s[i]=`id:${t.id}`:t.ph&&(s[i]=o(t.ph)),Ti.Util.Link({url:e,params:s})},wrapTreeNode(e){if(_.isPlainObject(e)){let t={id:e.id,name:e.nm,leaf:"DIR"!=e.race,rawData:e};if(t.leaf||(t.children=[]),t.id&&t.name)return t}},genQuery:(e,{vkey:t="val",wrapArray:i=!1,errorAs:n,blankAs:a="[]"}={})=>_.isFunction(e)?e:_.isArray(e)?i?()=>e:e:_.isString(e)?t?async i=>{let s=Ti.S.renderBy(e,{[t]:i});return await Wn.Sys.exec2(s,{as:"json",input:i,errorAs:n,blankAs:a})}:async t=>await Wn.Sys.exec2(e,{as:"json",errorAs:n,blankAs:a}):void 0};return e}(),Dict={evalOptionsDict({options:e,findBy:t,itemBy:i,childrenBy:n,valueBy:a,textBy:s,iconBy:o,dictShadowed:r=!0},l){let c=Ti.DictFactory.DictReferName(e);return c?Ti.DictFactory.CheckDict(c,l):Ti.DictFactory.CreateDict({data:Wn.Util.genQuery(e,{vkey:null,blankAs:"[]"}),query:Wn.Util.genQuery(t,{blankAs:"[]"}),item:Wn.Util.genQuery(i,{errorAs:null,blankAs:"{}"}),children:Wn.Util.genQuery(n,{errorAs:null,blankAs:"[]"}),getValue:Ti.Util.genGetter(a||"id|value"),getText:Ti.Util.genGetter(s||"title|text|nm"),getIcon:Ti.Util.genGetter(o||Wn.Util.getObjThumbIcon)},{shadowed:r,hooks:l})},setup(e){_.forEach(e,(e,t)=>{Ti.DictFactory.GetDict(t)||Ti.DictFactory.CreateDict({data:Wn.Util.genQuery(e.data,{vkey:null}),query:Wn.Util.genQuery(e.query),item:Wn.Util.genQuery(e.item,{blankAs:"{}"}),children:Wn.Util.genQuery(e.children),getValue:Ti.Util.genGetter(e.value),getText:Ti.Util.genGetter(e.text),getIcon:Ti.Util.genGetter(e.icon),shadowed:Ti.Util.fallback(e.shadowed,!0)},{name:t})})},hMakerComponents:()=>Ti.DictFactory.GetOrCreate({data:Wn.Util.genQuery("ti coms -cqn",{vkey:null}),getValue:e=>e.name,getText:e=>e.title||e.name,getIcon:e=>e.icon||"im-plugin",isMatched:(e,t)=>{if(e.name==t||e.title==t)return!0;if(e.name&&e.name.indexOf(t)>=0)return!0;if(e.title){if(e.title.indexOf(t)>=0)return!0;let i=Ti.I18n.text(e.title);if(i&&i.indexOf(t)>=0)return!0}return!1},shadowed:!0},{name:"hMakerComponents"})},Hm=function(){const e={background:{title:"i18n:hmk-css-background",name:"background",comType:"ti-input"},border:{title:"i18n:hmk-css-border",name:"border",comType:"ti-input"},"border-radius":{title:"i18n:hmk-css-border-radius",name:"border-radius",comType:"ti-input"},"box-shadow":{title:"i18n:hmk-css-box-shadow",name:"box-shadow",comType:"ti-input"},color:{title:"i18n:hmk-css-color",name:"color",comType:"ti-input-color"},float:{title:"i18n:hmk-css-float",name:"float",comType:"ti-switcher",comConf:{options:[{value:"none",text:"i18n:hmk-css-float-none",icon:"fas-align-justify"},{value:"left",text:"i18n:hmk-css-float-left",icon:"fas-align-left"},{value:"right",text:"i18n:hmk-css-float-right",icon:"fas-align-right"}]}},"font-size":{title:"i18n:hmk-css-font-size",name:"font-size",comType:"ti-input"},height:{title:"i18n:hmk-css-height",name:"height",comType:"ti-input"},"letter-spacing":{title:"i18n:hmk-css-letter-spacing",name:"letter-spacing",comType:"ti-input"},"line-height":{title:"i18n:hmk-css-line-height",name:"line-height",comType:"ti-input"},margin:{title:"i18n:hmk-css-margin",name:"margin",comType:"ti-input"},"max-height":{title:"i18n:hmk-css-max-height",name:"max-height",comType:"ti-input"},"max-width":{title:"i18n:hmk-css-max-width",name:"max-width",comType:"ti-input"},"min-height":{title:"i18n:hmk-css-min-height",name:"min-height",comType:"ti-input"},"min-width":{title:"i18n:hmk-css-min-width",name:"min-width",comType:"ti-input"},overflow:{title:"i18n:hmk-css-overflow",name:"overflow",fieldWidth:"100%",comType:"ti-switcher",comConf:{options:[{value:"auto",text:"i18n:hmk-css-c-auto"},{value:"scroll",text:"i18n:hmk-css-overflow-scroll"},{value:"hidden",text:"i18n:hmk-css-overflow-hidden"},{value:"clip",text:"i18n:hmk-css-overflow-clip"},{value:"visible",text:"i18n:hmk-css-overflow-visible"}]}},padding:{title:"i18n:hmk-css-padding",name:"padding",comType:"ti-input"},"text-align":{title:"i18n:hmk-css-text-align",name:"text-align",comType:"ti-switcher",comConf:{options:[{value:"left",tip:"i18n:hmk-css-align-left",icon:"fas-align-left"},{value:"center",tip:"i18n:hmk-css-align-center",icon:"fas-align-center"},{value:"right",tip:"i18n:hmk-css-align-right",icon:"fas-align-right"},{value:"justify",tip:"i18n:hmk-css-align-justify",icon:"fas-align-justify"}]}},"text-shadow":{title:"i18n:hmk-css-text-shadow",name:"text-shadow",comType:"ti-input"},"text-transform":{title:"i18n:hmk-css-text-transform",name:"text-transform",comType:"ti-switcher",comConf:{options:[{value:"capitalize",text:"i18n:hmk-css-text-transform-capitalize"},{value:"uppercase",text:"i18n:hmk-css-text-transform-uppercase"},{value:"lowercase",text:"i18n:hmk-css-text-transform-lowercase"}]}},"text-overflow":{title:"i18n:hmk-css-text-overflow",name:"text-overflow",comType:"ti-switcher",comConf:{options:[{value:"clip",text:"i18n:hmk-css-text-overflow-clip",icon:"fas-cut"},{value:"ellipsis",text:"i18n:hmk-css-text-overflow-ellipsis",icon:"fas-ellipsis-h"}]}},width:{title:"i18n:hmk-css-width",name:"width",comType:"ti-input"},"white-space":{title:"i18n:hmk-css-white-space",name:"white-space",comType:"ti-droplist",comConf:{options:[{value:"normal",text:"i18n:hmk-css-white-space-normal"},{value:"nowrap",text:"i18n:hmk-css-white-space-nowrap"},{value:"pre",text:"i18n:hmk-css-white-space-pre"},{value:"pre-wrap",text:"i18n:hmk-css-white-space-pre-wrap"},{value:"pre-line",text:"i18n:hmk-css-white-space-pre-line"},{value:"break-space",text:"i18n:hmk-css-white-space-break-space"}]}}},t={aspect:["margin","padding","border","border-radius","background","color","box-shadow","float","overflow"],measure:["width","height","max-width","max-height","min-width","min-height"],texting:["text-align","white-space","text-overflow","text-transform","font-size","letter-spacing","line-height","text-shadow"]};return{getCssPropTitle(t){let i=e[t];return i?i.title:t},getCssPropField(t,i={}){let n=_.cloneDeep(e[t]);if(n)return _.merge(n,i)},findCssPropFields(i=!0){let n={"#BLOCK":[/^(margin|padding|border|overflow|background)-?/,/^(box-shadow|float)$/,/^((max|min)-)?(width|height)$/],"#IMG":[/^(margin|border|obj|background)-?/,/^(box-shadow|float)$/,/^((max|min)-)?(width|height)$/],"#TEXT":[/^(color|background(-.+)?)$/,/^(text-(align|transform|shadow|overflow))$/,/^(font-size|line-height|letter-spacing|white-space)$/],"#TEXT-BLOCK":[/^(padding|border|color|background(-.+)?|overflow)$/,/^(text-(align|transform|shadow|overflow))$/,/^(font-size|line-height|letter-spacing|white-space)$/]}[i];n&&(i=n);let a=Ti.AutoMatch.parse(i),s={};_.forEach(e,(e,t)=>{a(t)&&(s[t]=e)});let o=[];return _.forEach(t,(e,t)=>{let i=[];for(let t of e){let e=s[t];e&&i.push(e)}if(i.length>0){let e={aspect:"as-vertical col-2",measure:"as-vertical col-2",texting:"as-vertical col-2"}[t];o.push({title:`i18n:hmk-css-grp-${t}`,className:e,fields:i})}}),o}}}(),OpenObjSelector=function(){return async function(e="~",{title:t="i18n:select",icon:i="im-folder-open",type:n="info",closer:a=!0,textOk:s="i18n:ok",textCancel:o="i18n:cancel",position:r="top",width:l="80%",height:c="90%",spacing:m,multi:d=!0,titleBy:p="title|nm",fromIndex:u=0,exposeHidden:h=!1,homePath:g=Wn.Session.getHomePath(),fallbackPath:y=Wn.Session.getHomePath(),sideItems:f=[],sideWidth:w="2rem",search:T={filter:{},sorter:{nm:1}},filter:b=(e=>"FILE"==e.race),canOpen:x=(e=>"DIR"==e.race),selected:k=[]}={}){let v=e;if(_.isString(e)&&(v=await Wn.Io.loadMeta(e)),!v&&y&&e!=y&&(v=await Wn.Io.loadMeta(y)),!v)return await Ti.Toast.Open({content:"i18n:e-io-obj-noexistsf",vars:_.isString(e)?{ph:e,nm:Ti.Util.getFileName(e)}:e.ph},"warn");let O=[];for(let e of f){let t=await Wn.Io.loadMeta(e);t&&O.push({depth:0,key:t.id,id:t.id,path:t.ph,icon:Ti.Icons.get(t),title:t.title||t.nm})}return"DIR"==v.race||(v=await Wn.Io.loadMetaById(v.pid))?await Ti.App.Open({type:n,width:l,height:c,spacing:m,position:r,closer:a,icon:i,title:t,actions:[{text:s,handler:({$main:e})=>e.myChecked},{text:o,handler:()=>void 0}],modules:{axis:"@mod:wn/obj-axis",current:"@mod:wn/obj-current"},comType:"modal-inner-body",components:["@com:ti/crumb","@com:wn/adaptlist","@com:wn/gui/side/nav",{name:"modal-inner-body",globally:!1,data:{myChecked:[],myShown:{side:O.length>1}},props:{icon:void 0,text:void 0,trimed:void 0,placeholder:void 0,valueCase:void 0,value:void 0},template:'<ti-gui\n          :layout="TheLayout"\n          :schema="TheSchema"\n          :shown="myShown"\n          :can-loading="true"\n          :loading-as="status.reloading"\n          @item:active="OnCurrentMetaChange"\n          @arena::open:wn:obj="OnCurrentMetaChange"\n          @arena::select="OnArenaSelect"/>',computed:{...Vuex.mapState("axis",["ancestors","parent"]),...Vuex.mapState("current",["meta","content","data","status","fieldStatus"]),CrumbData(){let e=Wn.Obj.evalCrumbData({meta:this.meta,ancestors:this.ancestors,fromIndex:u,homePath:g,titleBy:p,iteratee:(e,t,{nm:i}={})=>{if(h||!i||!i.startsWith("."))return e}});return _.isEmpty(e)||(e[0].icon=null),e},SideConfig(){return{items:O,highlightItemId:_.get(this.meta,"id"),highlightItemPath:_.get(this.meta,"ph")}},TheLayout:()=>({type:"rows",border:!0,blocks:[{name:"sky",size:".5rem",body:"sky"},{type:"cols",border:!0,blocks:[{name:"side",size:w,body:"side"},{name:"arena",body:"main"}]}]}),TheSchema(){return{sky:{comType:"ti-crumb",comConf:{style:{padding:"0 .1rem"},data:this.CrumbData}},side:{comType:"wn-gui-side-nav",comConf:this.SideConfig},main:{comType:"wn-adaptlist",comConf:{meta:this.meta,data:this.data,status:this.status,multi:d,listConf:{resizeDelay:200}}}}}},methods:{OnCurrentMetaChange({id:e,path:t,value:i}={}){this.open(e||t||i)},OnArenaSelect({checked:e}){_.isFunction(b)?this.myChecked=_.filter(e,b):this.myChecked=e},async open(e){if(e)if(_.isString(e)&&(e=await Wn.Io.loadMetaBy(e)),x(e)){let t=Ti.App(this);T&&(t.commit("current/setFilter",T.filter||{}),t.commit("current/setSorter",T.sorter||{nm:1})),t.dispatch("current/reload",e),t.dispatch("axis/reload",e)}else console.log(this.myChecked),this.$notify("ok",this.myChecked)}},mounted:function(){this.open(v)}}]}):await Ti.Toast.Open({content:"i18n:e-io-obj-noexistsf",vars:{ph:`Parent of id:${v.id}->pid:${v.pid}`,nm:`Parent of id:${v.nm}->pid:${v.pid}`}},"warn")}}(),OpenThingManager=function(){return async function(e,{textOk:t="i18n:ok",icon:i="fas-database",title:n,ok:a=(({result:e})=>e),textCancel:s="i18n:close",position:o="top",width:r="96%",height:l="96%",spacing:c}={}){if(Ti.Util.isNil(e))return await Ti.Toast.Open("ThingSet path is nil","warn");let m=_.isString(e)?await Wn.Io.loadMeta(e):e;if(!m)return await Ti.Toast.Open(`Fail to found ThingSet: ${e}`,"warn");m.th_auto_select=!1;let d=await Wn.Sys.exec(`ti views id:${m.id} -cqn`,{as:"json"});return await Ti.App.Open({icon:i,title:n||m.title||m.nm,position:o,width:r,height:l,escape:!1,topActions:d.actions,textOk:t,textCancel:s,ok:a,modules:{current:"@mod:wn/obj-current",main:"@mod:wn/thing"},comType:"wn-thing-manager",comConf:{"...":"=Main",emitChange:!0},components:["@com:wn/thing/manager"],preload:async function(e){e.commit("current/setMeta",m),await e.dispatch("main/reload",m)}})}}(),EditObjMeta=function(){return async function(e="~",{icon:t,title:i,type:n="info",closer:a=!0,escape:s=!0,textOk:o="i18n:ok",textCancel:r="i18n:cancel",position:l="top",width:c=640,height:m="90%",spacing:d,currentTab:p=0,fields:u=[],fixedKeys:h=["icon","thumb","title"],saveKeys:g=["thumb"],autoSave:y=!0}={}){let f=e;_.isString(f)&&(f=await Wn.Io.loadMeta(e));let w={};_.forEach(h,e=>w[e]=!0);let T={};if(_.forEach(g,e=>T[e]=!0),"auto"==u){let e=await Wn.Sys.exec2(`ti metas id:${f.id} -cqn`,{as:"json"});e&&(u=e.fields,p=e.currentTab||p||0)}!_.isEmpty(u)&&_.isArray(u)||(u=[{title:"basic",fields:["id","nm","title","icon","thumb","ph","race","tp","mime","width","height","len","sha1","sort"]},{title:"privilege",fields:["c","m","g","md","pvg"]},{title:"timestamp",fields:["ct","lm","expi"]},{title:"others",fields:["..."]}]);let b=Wn.Obj.evalFields(f,u,e=>w[e.uniqKey]?e:e.quickName&&_.isUndefined(e.value)?void 0:e),x=t||Wn.Util.getObjIcon(f,"zmdi-info-outline"),k=i||Wn.Util.getObjDisplayName(f),v=await Ti.App.Open({type:n,width:c,height:m,spacing:d,position:l,closer:a,escape:s,icon:x,title:k,actions:[{text:o,handler:({$main:e})=>_.cloneDeep({updates:e.updates,data:e.meta})},{text:r,handler:({$main:e})=>{let t=_.keys(e.updates);for(let i of t)if(T[i])return _.cloneDeep({updates:e.updates,data:e.meta})}}],ready(){this.$main.meta=f},comType:"modal-inner-body",components:[{name:"modal-inner-body",globally:!1,data:{myFormFields:b,currentTab:p,meta:void 0,updates:{}},template:'<ti-form\n          mode="tab"\n          :current-tab="currentTab"\n          :fields="myFormFields"\n          :data="meta"\n          @field:change="onFieldChange"\n          @change="onChange"\n          />',methods:{onChange(e){this.meta=e},onFieldChange({name:e,value:t}={}){let i=Ti.Types.toObjByPair({name:e,value:t});this.updates=_.assign({},this.updates,i)}}},"@com:ti/form","@com:ti/input/text","@com:wn/imgfile","@com:wn/obj/mode"]});if(!v)return;let{updates:O}=v,S=!1;if(y&&!_.isEmpty(O)){let e=JSON.stringify(O),t=`obj 'id:${f.id}' -ocqn -u`,i=await Wn.Sys.exec2(t,{input:e,as:"json"});return await Ti.Toast.Open("i18n:save-done","success"),S=!0,{updates:O,data:i,saved:S}}return v}}(),EditObjContent=function(){return async function(e="~",{title:t,icon:i,type:n="info",closer:a=!0,textOk:s,textCancel:o="i18n:cancel",position:r="top",width:l="80%",height:c="96%",spacing:m,readonly:d=!1,showEditorTitle:p=!0,content:u,placeholder:h="i18n:blank",autoSave:g}={}){let y=e;_.isString(y)&&(y=await Wn.Io.loadMeta(e)),_.isUndefined(s)&&(s=this.saveBy?"i18n:save":"i18n:ok"),g=Ti.Util.fallback(g,Ti.Util.isNil(u));let f=i||Wn.Util.getObjIcon(y,"zmdi-receipt"),w=t||"i18n:edit",T=g?await Wn.Io.loadContent(y):u,b=await Ti.App.Open({type:n,width:l,height:c,spacing:m,position:r,closer:a,title:w,result:T,comType:"ti-text-raw",comConf:{readonly:d,placeholder:h,icon:f,title:Wn.Util.getObjDisplayName(y),content:T,showTitle:p,ignoreKeyUp:!0},components:["@com:ti/text/raw"]});return g&&!_.isUndefined(b)&&b!=T&&(await Wn.Io.saveContentAsText(y,b),await Ti.Toast.Open("i18n:save-done","success")),b}}(),EditObjPrivilege=function(){return async function(e="~",{icon:t="fas-user-lock",title:i="i18n:wn-key-pvg",type:n="info",closer:a=!0,escape:s=!0,position:o="top",width:r=640,height:l="95%",autoSave:c=!0}={}){let m=e;_.isString(m)&&(m=await Wn.Io.loadMeta(e));let d=Ti.I18n.text(i)+" : "+(m.title||m.nm),p=await Ti.App.Open({type:n,width:r,height:l,position:o,closer:a,escape:s,icon:t,title:d,result:m.pvg,comType:"WnObjPrivilege",components:["@com:wn/obj/privilege"]});if(p&&!_.isEqual(m.pvg,p)){if(c){let e=_.isEmpty(p)?{"!pvg":!0}:{pvg:p},t=JSON.stringify(e),i=`o 'id:${m.id}' @update @json -cqn`,n=await Wn.Sys.exec2(i,{input:t,as:"json"});return await Ti.Toast.Open("i18n:save-done","success"),n}return m.pvg=p,m}}}(),EditTiComponent=function(){return async function({comType:e,comConf:t}={},{icon:i="fas-pencil-ruler",title:n="i18n:edit-com",type:a="info",closer:s=!0,textOk:o="i18n:ok",textCancel:r="i18n:cancel",position:l="top",width:c=800,height:m="90%",spacing:d}={}){return await Ti.App.Open({type:a,width:c,height:m,spacing:d,position:l,closer:s,icon:i,title:n,textOk:o,textCancel:r,comType:"hmaker-edit-com",comConf:{value:{comType:e,comConf:t}},result:{comType:e,comConf:_.cloneDeep(t)},components:["@com:hmaker/edit-com"]})}}(),OpenCmdPanel=function(){return async function(e,{title:t="i18n:run",icon:i="fas-running",type:n="info",closer:a=!0,textCancel:s="i18n:close",position:o="top",width:r="80%",height:l="90%",spacing:c,vars:m,input:d,forceFlushBuffer:p,showRunTip:u,cmdTipText:h,cmdTipIcon:g,onBodyReady:y,beforeClosed:f}={}){await Ti.App.Open({type:n,width:r,height:l,spacing:c,position:o,closer:a,icon:i,title:t,textCancel:s,textOk:null,model:null,ready:e=>{_.isFunction(y)&&y(e)},beforeClosed:f,comType:"WnCmdPanel",comConf:{value:e,tipText:h,tipIcon:g,vars:m,input:d,forceFlushBuffer:p,showRunTip:u},components:["@com:wn/cmd/panel"]})}}(),Youtube=function(){const e={async getVideoDetails(e,t=[]){if(!e||_.isEmpty(t))return;let{domain:i,thumbType:n}=e,a=`xapi req youtube ${i} videos -url -vars '${JSON.stringify({id:t.join(","),part:e.videoPart})}'`,s=await Wn.Sys.exec2(a,{as:"text"});if(!s)throw"Fail to get youtube API(videos) URL: "+a;let o=await Ti.Http.get(s,{as:"json"});if(!o||!_.isArray(o.items))throw"Fail to load youtube playlists by: "+a;let r=[];return _.forEach(o.items,e=>{let{id:t,snippet:i,contentDetails:a}=e,s={id:t,title:i.title,publishedAt:i.publishedAt,description:i.description,thumbUrl:_.get(i,`thumbnails.${n}.url`),defaultLanguage:i.defaultLanguage,defaultAudioLanguage:i.defaultAudioLanguage,categoryId:i.categoryId,duration:a.duration,definition:a.definition},o=Ti.DateTime.parseTime(s.duration);s.du_in_sec=o.value,s.du_in_str=o.toString("min"),r.push(s)}),r},async getAllVideos(t,i){if(!t)return;let n=await e.getPlaylistVideos(t,i),a=n.list||[];for(;n.next;)n=await e.getPlaylistVideos(t,i,{pageToken:n.next}),a=_.concat(a,n.list);return a},async getPlaylistVideos(t,i,{pageToken:n,maxResults:a=50}={}){if(!t)return;let{domain:s}=t;i=i||t.uploadsPlaylistId;let o=`xapi req youtube ${s} playlistItems -url -vars '${JSON.stringify({playlistId:i,part:"contentDetails",pageToken:n,maxResults:a})}'`,r=await Wn.Sys.exec2(o,{as:"text"});if(!r)throw"Fail to get youtube API(playlistItems) URL: "+o;let l=await Ti.Http.get(r,{as:"json"});if(!l||!_.isArray(l.items))throw"Fail to load youtube playlistItems by: "+o;let c=[];_.forEach(l.items,e=>{let t=_.get(e.contentDetails,"videoId");c.push(t)});return{list:await e.getVideoDetails(t,c),prev:l.prevPageToken,next:l.nextPageToken}},async getAllPlaylists(t,{force:i=!1}={}){if(!t)return;let{domain:n}=t,a=`~/.domain/youtube/${n}`,s=await Wn.Io.loadMeta(`${a}/playlists.json`),o=!0,r=[];if(s&&(r=await Wn.Io.loadContent(s,{as:"json"}),o=!1),o||i){let i=await e.getPlaylists(t);for(r=i.list||[];i.next;)i=await e.getPlaylists(t,{pageToken:i.next}),r=_.concat(r,i.list);let n=JSON.stringify(r);await Wn.Sys.exec2(`json -qn > ${a}/playlists.json`,{input:n})}return r},async getPlaylists(e,{pageToken:t,maxResults:i=50}={}){if(!e)return;let{domain:n,channelId:a,thumbType:s}=e,o=`~/.domain/youtube/${n}`,r=JSON.stringify({channelId:a,part:e.playlistPart,pageToken:t,maxResults:i}),l=`xapi req youtube ${n} playlists -url -vars '${r}'`,c=await Wn.Sys.exec2(l,{as:"text"});if(!c)throw"Fail to get youtube API(playlist) URL: "+l;let m=await Ti.Http.get(c,{as:"json"});if(!m||!_.isArray(m.items))throw"Fail to load youtube playlists by: "+l;r=JSON.stringify(m);let d=t?`_${t}.json`:".json";await Wn.Sys.exec2(`json -qn > ${o}/results/playlists${d}`,{input:r});let p=[];return _.forEach(m.items,e=>{let{id:t,snippet:i,contentDetails:n}=e,a={id:t,title:i.title,description:i.description,thumbUrl:_.get(i,`thumbnails.${s}.url`),itemCount:n.itemCount};p.push(a)}),{list:p,prev:m.prevPageToken,next:m.nextPageToken}},async loadConfig({domain:e,channelId:t,force:i=!1}={}){e||(e=Wn.Session.getCurrentDomain());let n=`~/.domain/youtube/${e}`,a=await Wn.Io.loadMeta(`${n}/youtube.json`),s=!0,o={};if(a&&(o=await Wn.Io.loadContent(a,{as:"json"}),s=!1),_.defaults(o,{domain:e,thumbType:"high",maxResults:50,channelId:t,channelTitle:"No Title",channelPart:"snippet,contentDetails,statistics",uploadsPlaylistId:null,playlistPart:"snippet,contentDetails,status,id,player,localizations",videoPart:"snippet,contentDetails,status,id,player"}),s||i){let i=JSON.stringify({id:t,part:o.channelPart}),a=`xapi req youtube ${e} channels -url -vars '${i}'`,s=await Wn.Sys.exec2(a,{as:"text"});if(!s)throw"Fail to get youtube API(channels) URL: "+a;let r=await Ti.Http.get(s,{as:"json"});if(!r||!_.isArray(r.items)||_.isEmpty(r.items))throw"Fail to load youtube channels by: "+a;i=JSON.stringify(r),await Wn.Sys.exec2(`json -qn > ${n}/results/channels.json`,{input:i}),o.channelTitle=_.get(r,"items.0.snippet.title"),o.uploadsPlaylistId=_.get(r,"items.0.contentDetails.relatedPlaylists.uploads"),i=JSON.stringify(o),await Wn.Sys.exec2(`json -qn > ${n}/youtube.json`,{input:i})}return o}};return e}(),WALNUT_VERSION="1.2-20210420.200941",HOOKs={};export const Wn={Version:WALNUT_VERSION,Io:Io,Obj:Obj,Session:Session,Sys:Sys,Util:Util,Dict:Dict,Hm:Hm,OpenObjSelector:OpenObjSelector,EditObjMeta:EditObjMeta,EditObjContent:EditObjContent,EditObjPrivilege:EditObjPrivilege,EditTiComponent:EditTiComponent,OpenThingManager:OpenThingManager,OpenCmdPanel:OpenCmdPanel,Youtube:Youtube,addHook(e,t){Ti.Util.pushValue(HOOKs,e,t)},doHook(e,t){let i=HOOKs[e];if(_.isArray(i)&&i.length>0)for(let e of i)e(t)}};export default Wn;window&&(window.Wn=Wn);