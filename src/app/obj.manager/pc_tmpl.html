<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${title}</title>
  <link rel="stylesheet" type="text/css"
        href="${rs}/core/css/font-md/css/material-design-iconic-font.css">
  <script src="${rs}/ti/deps/axios.min.js"></script>
  <script src="${rs}/ti/deps/lodash.min.js"></script>
  <script src="${rs}/ti/deps/vue.js"></script>
  <script src="${rs}/ti/deps/vuex.js"></script>
</head>
<body>
<main id="app">
  Loading...
</main>
</body>
<script type="module">
import {Ti} from "${rs}/ti/core/ti.mjs"
//---------------------------------------
window._app = ${app};
//---------------------------------------
Ti.SetForDev(true)
//---------------------------------------
Ti.Config.set({
  prefix : {
    "app"   : "/a/load/",
    "MyApp" : "/a/load/${appName}/",
    "theme" : "${rs}/ti/theme/",
    "jslib" : "${rs}/core/js/"
  },
  alias : {
    "^\./"          : "@MyApp:",
    "@jslib:jquery" : "@jslib:jquery/2.x/jquery.min.js",
    "^@MyApp:?$"    : "@MyApp:_app.json",
    "^@theme:.+$"   : "$&.css",
    "^@app:[^\/]+$"   : "$&/_app.json",
    "\/?mod\/[^\/]+$" : "$&/_mod.json",
    "\/?com\/[^\/]+$" : "$&/_com.json"
  }
})
//---------------------------------------
async function main(){
  let app = await Ti.App("@MyApp")
  await app.init()
  console.log(app)
  app.mountTo("#app")
  
  app.$store().commit("session/set", _app.session)

  _.delay(()=>{
    app.$store().commit("session/setName", "NoName")
  }, 2000)
}
main()

</script>
</html>