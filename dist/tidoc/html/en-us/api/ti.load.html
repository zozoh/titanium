<html>
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ti.load</title>
</head>
<body>
<article>
<hr>
<p>title : ti.load<br>author: zozoh(zozohtnt@gmail.com)<br>tags:<br>- API<br>- namespace
</p>
<hr>
<hr>
<h1><code>ti.load</code> Overview
</h1>
<ul>
<li><a href="#run">run
</a> : Do the resource loading.
</li>
<li><a href="#explain">explain
</a> : Brief resource loading map for a glance.
</li>
</ul>
<hr>
<h1><code>ti.load.run</code> Loading Resource
</h1>
<pre code-type="js">run(path, {recur=true,forceArray=false}={}): Promise
</pre>
<blockquote>@see
</blockquote>
<blockquote>- <a href="ti.config.html"><code>ti.config</code>
</a>
</blockquote>
<blockquote>- <a href="ti.use.html"><code>ti.use</code>
</a>
</blockquote>
<h2><code>run@params</code>
</h2>
<ul>
<li><code>path{String|Array}</code> : see <a href="#load.path">load.path
</a> for more detail.
</li>
<li><code>recur{Boolean}</code> : explain the resource loading chain deeply
</li>
<li><code>forceArray{Boolean}</code> : Whatever <code>path</code> is array or not, always return array
</li>
</ul>
<h2><code>load.path</code>
</h2>
<p>The path of resouce to be loaded. If An <code>Array</code> has been passed on, the return value (<code>Promise.then</code>) should be <code>Array</code> also.
</p>
<p>A path formed like:
</p>
<pre>[Loading Mode][@[Prefix]:][Path]
</pre>
<p>for example:
</p>
<pre code-type="bash"># load jQuery library
&quot;js@lib:jquery&quot;

# load foo.bar/app.json
&quot;app@app:foo.bar&quot;

# load foo.bar/components/profile/com.json
&quot;com@app:components/profile&quot;
</pre>
<p>All supported <code>Loading Mode</code> is below:
</p>
<table><thead>
<tr><th>Mode
</th><th>UseType
</th><th>Recur
</th><th>AutoSuffix
</th>
</tr>
</thead><tbody>
<tr>
<td><code>text</code>
</td>
<td><code>text</code>
</td>
<td><em>No</em>
</td>
<td><em>None</em>
</td>
</tr>
<tr>
<td><code>js</code>
</td>
<td><code>script</code>
</td>
<td><em>No</em>
</td>
<td><code>.js</code>
</td>
</tr>
<tr>
<td><code>!js</code>
</td>
<td><code>script</code>
</td>
<td><em>No</em>
</td>
<td><em>None</em>
</td>
</tr>
<tr>
<td><code>css</code>
</td>
<td><code>css</code>
</td>
<td><em>No</em>
</td>
<td><code>.css</code>
</td>
</tr>
<tr>
<td><code>!css</code>
</td>
<td><code>css</code>
</td>
<td><em>No</em>
</td>
<td><em>None</em>
</td>
</tr>
<tr>
<td><code>json</code>
</td>
<td><code>json</code>
</td>
<td><em>No</em>
</td>
<td><em>None</em>
</td>
</tr>
<tr>
<td><code>app</code>
</td>
<td><code>json</code>
</td>
<td><b>Yes</b>
</td>
<td><code>/app.json</code>
</td>
</tr>
<tr>
<td><code>com</code>
</td>
<td><code>json</code>
</td>
<td><b>Yes</b>
</td>
<td><code>/com.json</code>
</td>
</tr>
<tr>
</tr>
</tbody>
</table>
<p>If you don't declare the <code>Loading Mode</code>, it will be auto detected by url suffix.
</p>
<pre>Loading Mode      | Auto Detected
</pre>
<p>--------------------|-------------------------<br><code>&quot;css@theme:light&quot;</code> | <code>&quot;@theme:light.css&quot;</code><br><code>&quot;app@app:foo.bar&quot;</code> | <code>&quot;@app:foo.bar/app.json&quot;</code><br><code>&quot;com@ti:my.com&quot;</code>   | <code>&quot;@ti:my.com/com.json&quot;</code>
</p>
<h2><code>run@return</code>
</h2>
<p><code>Promise</code> object.
</p>
<p>If An array has been passed on, the return value (<code>Promise.then</code>) will be array also. The value created by <a href="ti.use.html">ti.use
</a>, relay on the specifical resource type.
</p>
<p>That is to say, if you passed one single string value as the param <code>path</code>, it will invoke the <a href="ti.use.html">ti.use
</a> to load the resource, when it's been done, the return value, which defined in <a href="ti.use.html">ti.use
</a> will be passed to the <code>resolve</code> method.
</p>
<p>If you passed an array, each element is a string as the path, it will invoke <a href="ti.use.html">ti.use
</a> by <code>Promise.all</code>, if all resources have been loaded, an array which contains the return value of each resource will be passed to the <code>resolve</code> method. Of cause, the order is the same as the input param <code>path</code>.
</p>
<h2><code>run@thrown</code>
</h2>
<ul>
<li><code>{errCode:&quot;e.ti.load.invalid_path&quot;, data:[path]}</code>
</li>
</ul>
<h2><code>run@usage</code>
</h2>
<pre code-type="js">ti.load.run(&quot;js@lib:lodash&quot;).then(re=&gt;console.log(re))
// -&gt; &lt;script&gt; Element

ti.load.run([&quot;js@lib:lodash&quot;, &quot;js@lib:jquery&quot;])
  .then(re=&gt;console.log(re))
// -&gt; [&lt;script&gt; Element, &lt;script&gt; Element]
</pre>
<hr>
<h1><code>ti.load.explain</code> What Will Be Loaded
</h1>
<pre code-type="js">explain(path, {recur=false,forceArray=false}={}): {Promise|Object}
</pre>
<p>It is given you a way to get the resource loading chain for your understanding of what will be loaded by <code>ti.load.run</code> actually.
</p>
<h2><code>explain@params</code>
</h2>
<ul>
<li><code>path{String|Array}</code>
</li>
<li><code>recur{Boolean}</code>
</li>
<li><code>forceArray{Boolean}</code>
</li>
</ul>
<p>Please see <a href="#run@params">run@params
</a>
</p>
<h2><code>explain@return</code>
</h2>
<p><code>Object</code> when you passed <code>{recur:false}</code>.
</p>
<p><code>Promise</code> when you passed <code>{recur:true}</code>, for the reason, it may has to be sent async request to server for several times. You will received the map object in <code>Promise.then</code>
</p>
<p>The form of map object look like this:
</p>
<pre code-type="js">[{
  &quot;mode&quot; : &quot;js&quot;,      // loading mode
  &quot;type&quot; : &quot;script&quot;,  // resource type
  &quot;name&quot; : &quot;@lib:jquery&quot;,         // resource name
  &quot;target&quot; : &quot;/rs/js/jquery.js&quot;,  // full path of the resource
  &quot;autoSuffix&quot; : &quot;.js&quot;,
  &quot;canRecur&quot; : false,
  &quot;index&quot;  : 0,   // The index of result list
  &quot;data&quot; : [Script Element]
}, {
  &quot;mode&quot; : &quot;app&quot;,
  &quot;type&quot; : &quot;json&quot;,
  &quot;name&quot; : &quot;@app:foo.bar&quot;,
  &quot;target&quot; : &quot;/rs/app/foo.bar/app.json&quot;,
  &quot;indexes&quot; : 1,
  &quot;autoSuffix&quot; : &quot;/app.json&quot;,
  &quot;canRecur&quot; : true,
  &quot;data&quot; : {/*..content of app.json*/},
}]
</pre>
<p>The field value of <code>type</code> can be one of the <code>&quot;css|app|com|json|text&quot;</code>ï¼Œ [SameValueZero][svz] default should be <code>&quot;text&quot;</code>
</p>
<p>If <code>type</code> is <code>&quot;app&quot;</code> or <code>&quot;com&quot;</code>, received value should be parsed to <code>data</code> field, then it will be analyzed deeply when <code>{recur:true}</code>
</p>
<h2><code>explain@usage</code>
</h2>
<pre code-type="js">ti.load.explain(&quot;app@app:my.app&quot;).then(re=&gt;console.log(re))
/*-&gt;
{
  &quot;type&quot; : &quot;js&quot;,
  &quot;name&quot; : &quot;@app:my.app&quot;,
  &quot;target&quot; : &quot;/rs/app/my.app/app.json&quot;,
  &quot;index&quot;  : 0,
  &quot;data&quot; : {
    ...
  }
}
*/
</pre>
<h2>@see
</h2>
<ul>
<li><a href="ti.config.html"><code>ti.config</code>
</a>
</li>
<li><a href="ti.use.html"><code>ti.use</code>
</a>
</li>
</ul>
<p>[svz]:<a href="http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero">http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero
</a>
</p>

</article>
</body>
</html>
